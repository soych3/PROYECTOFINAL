<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="FashionStore - Tienda online de ropa y moda con las mejores marcas. Compra ropa para hombre y mujer con estilo.">
    <meta name="keywords" content="tienda online, ropa, moda, fashion, compras, hombre, mujer">
    <meta name="author" content="FashionStore">
    <meta property="og:title" content="FashionStore - Tu tienda de moda online">
    <meta property="og:description" content="Descubre nuestra selecci√≥n de ropa y accesorios de moda">
    <meta property="og:type" content="website">
    <title>FashionStore - Tienda Online de Ropa y Moda</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark">
            <div class="container">
                <a class="navbar-brand" href="#inicio" aria-label="FashionStore - Ir a inicio">FashionStore</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Abrir men√∫ de navegaci√≥n">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item"><a class="nav-link active" href="index.html">Inicio</a></li>
                        <li class="nav-item"><a class="nav-link" href="contacto.html">Contacto</a></li>
                        <li class="nav-item">
                            <a class="btn btn-cart" href="carrito.html" aria-label="Ver carrito de compras">
                                üõí Carrito <span class="badge bg-danger" id="contadorCarrito">0</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section id="inicio" class="hero-section">
            <div class="container">
                <div class="hero-content">
                    <h1>Bienvenido a FashionStore</h1>
                    <p>Descubre las √∫ltimas tendencias en moda</p>
                    <a href="#productos" class="btn btn-primary btn-lg">Ver Productos</a>
                </div>
            </div>
        </section>

        <section id="productos" class="productos-section">
            <div class="container">
                <h2 class="section-title">Nuestra Colecci√≥n de Ropa</h2>
                <div class="loading" id="loading" role="status" aria-live="polite">
                    <p>Cargando productos...</p>
                </div>
                <div class="productos-grid" id="productosContainer" role="list"></div>
            </div>
        </section>

        <section id="resenas" class="resenas-section">
            <div class="container">
                <h2 class="section-title">Rese√±as de Clientes</h2>
                <div class="resenas-grid" id="resenasContainer"></div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <p>&copy; 2025 FashionStore. Todos los derechos reservados.</p>
                <ul class="footer-links">
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="contacto.html">Contacto</a></li>
                    <li><a href="carrito.html">Carrito</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ===============================================
        // RENDERIZADO DIN√ÅMICO - Consulta via fetch HTTP
        // ===============================================
        
        // URL del archivo JSON local de productos
        const PRODUCTOS_URL = 'productos.json';
        let carrito = JSON.parse(localStorage.getItem('carrito')) || [];

        document.addEventListener('DOMContentLoaded', () => {
            cargarProductos();
            cargarResenas();
            actualizarContadorCarrito();
        });

        // Funci√≥n as√≠ncrona para cargar productos desde el JSON local via fetch (HTTP)
        async function cargarProductos() {
            const container = document.getElementById('productosContainer');
            const loading = document.getElementById('loading');

            try {
                // Consulta HTTP as√≠ncrona al archivo productos.json
                const response = await fetch(PRODUCTOS_URL);
                
                // Verificar si la respuesta es exitosa
                if (!response.ok) {
                    throw new Error(`Error HTTP: ${response.status}`);
                }
                
                // Parsear la respuesta JSON de forma as√≠ncrona
                const productos = await response.json();
                
                loading.style.display = 'none';
                
                // Renderizado din√°mico de productos desde el JSON
                productos.forEach(producto => {
                    const card = crearCardProducto(producto);
                    container.appendChild(card);
                });
                
                console.log(`‚úÖ Se cargaron ${productos.length} productos desde ${PRODUCTOS_URL}`);
                
            } catch (error) {
                console.error('Error al cargar productos:', error);
                loading.innerHTML = '<p>Error al cargar productos. Por favor, intenta m√°s tarde.</p>';
            }
        }

        // Crear tarjeta de producto din√°micamente
        function crearCardProducto(producto) {
            const article = document.createElement('article');
            article.className = 'producto-card';
            article.setAttribute('role', 'listitem');
            
            article.innerHTML = `
                <img src="${producto.image}" alt="${producto.title}">
                <h3>${producto.title}</h3>
                <p class="producto-precio">$${producto.price.toFixed(2)}</p>
                <button class="btn-agregar" data-id="${producto.id}" data-titulo="${producto.title.replace(/"/g, '&quot;')}" data-precio="${producto.price}" data-imagen="${producto.image}" aria-label="Agregar ${producto.title} al carrito">
                    Agregar al Carrito
                </button>
            `;
            
            const btnAgregar = article.querySelector('.btn-agregar');
            btnAgregar.addEventListener('click', agregarAlCarrito);
            
            return article;
        }

        // Agregar producto al carrito (localStorage)
        function agregarAlCarrito(e) {
            const btn = e.target;
            const producto = {
                id: parseInt(btn.dataset.id),
                titulo: btn.dataset.titulo,
                precio: parseFloat(btn.dataset.precio),
                imagen: btn.dataset.imagen
            };
            
            const itemExistente = carrito.find(item => item.id === producto.id);
            
            if (itemExistente) {
                itemExistente.cantidad++;
            } else {
                carrito.push({ ...producto, cantidad: 1 });
            }
            
            guardarCarrito();
            actualizarContadorCarrito();
            mostrarMensaje();
        }

        // Guardar carrito en localStorage
        function guardarCarrito() {
            localStorage.setItem('carrito', JSON.stringify(carrito));
        }

        // Actualizar contador del carrito
        function actualizarContadorCarrito() {
            const contador = document.getElementById('contadorCarrito');
            if (contador) {
                const total = carrito.reduce((sum, item) => sum + item.cantidad, 0);
                contador.textContent = total;
            }
        }

        // Animaci√≥n al agregar producto
        function mostrarMensaje() {
            const contador = document.getElementById('contadorCarrito');
            if (contador) {
                contador.classList.add('animate');
                setTimeout(() => contador.classList.remove('animate'), 300);
            }
        }

        // Cargar rese√±as desde JSON via fetch
        async function cargarResenas() {
            const container = document.getElementById('resenasContainer');
            if (!container) return;

            try {
                const response = await fetch('resenas.json');
                const resenas = await response.json();
                
                resenas.forEach(resena => {
                    const card = crearCardResena(resena);
                    container.appendChild(card);
                });
            } catch (error) {
                container.innerHTML = '<p>Error al cargar rese√±as.</p>';
            }
        }

        // Crear tarjeta de rese√±a din√°micamente
        function crearCardResena(resena) {
            const article = document.createElement('article');
            article.className = 'resena-card';
            
            const estrellas = '‚≠ê'.repeat(resena.rating);
            
            article.innerHTML = `
                <img src="${resena.avatar}" alt="Foto de perfil de ${resena.nombre}" class="resena-avatar">
                <h3>${resena.nombre}</h3>
                <p class="resena-rating">${estrellas}</p>
                <p>"${resena.comentario}"</p>
            `;
            
            return article;
        }
    </script>

</body>
</html>
